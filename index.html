<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algoritmo de Bresenham - Centro (0,0)</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <div>
        <h1>Algoritmo de Bresenham - Centro (0,0)</h1>
        <canvas id="bresenhamCanvas" width="500" height="500"></canvas>
        <p>Bresenham</p>
        <label for="x0">x0:</label>
        <input type="number" name="x0" id="x0" value="0">
        <label for="y0">y0:</label>
        <input type="number" name="y0" id="y0" value="0">
        <label for="x1">x1:</label>
        <input type="number" name="x1" id="x1" value="10">
        <label for="y1">y1:</label>
        <input type="number" name="y1" id="y1" value="10">

        <button type="button" onclick="desenharBresenham()">Desenhar Bresenham</button>

        <button type="button" onclick="desenharCirculo()">Desenhar Circulo</button>

        <button type="button" onclick="desenharElipse()">Desenhar elipse</button>
    </div>

    <script>
        // Função para desenhar o grid de fundo
        function drawGrid(ctx, canvasWidth, canvasHeight, gridSize) {
            ctx.strokeStyle = '#ddd';  // Cor do grid
            ctx.lineWidth = 1;

            // Desenhar linhas verticais
            for (let x = 0; x <= canvasWidth; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvasHeight);
                ctx.stroke();
            }

            // Desenhar linhas horizontais
            for (let y = 0; y <= canvasHeight; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvasWidth, y);
                ctx.stroke();
            }

            // Desenha os eixos X e Y
            ctx.strokeStyle = '#000';  // Cor dos eixos
            ctx.lineWidth = 2;

            // Eixo X (horizontal, passa no centro)
            ctx.beginPath();
            ctx.moveTo(0, canvasHeight / 2);
            ctx.lineTo(canvasWidth, canvasHeight / 2);
            ctx.stroke();

            // Eixo Y (vertical, passa no centro)
            ctx.beginPath();
            ctx.moveTo(canvasWidth / 2, 0);
            ctx.lineTo(canvasWidth / 2, canvasHeight);
            ctx.stroke();
        }

        // Função que implementa o algoritmo de Bresenham
        function bresenhamLine(x0, y0, x1, y1) {
            let points = [];
            let dx = Math.abs(x1 - x0);
            let dy = Math.abs(y1 - y0);
            let sx = (x0 < x1) ? 1 : -1;
            let sy = (y0 < y1) ? 1 : -1;
            let err = dx - dy;

            while (true) {
                points.push({x: x0, y: y0});
                if (x0 === x1 && y0 === y1) break;
                let e2 = 2 * err;
                if (e2 > -dy) {
                    err -= dy;
                    x0 += sx;
                }
                if (e2 < dx) {
                    err += dx;
                    y0 += sy;
                }
            }
            return points;
        }

        // Função para desenhar a linha no canvas
        function drawLine(points) {
            const canvas = document.getElementById('bresenhamCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpa o canvas

            // Desenha o grid de fundo
            drawGrid(ctx, canvas.width, canvas.height, 10);

            // Centraliza o ponto (0, 0) no meio do canvas
            const centerX = canvas.width  / 2;
            const centerY = canvas.height / 2;

            // Desenha cada ponto
            ctx.fillStyle = 'blue';
            points.forEach(point => {
                // Desloca as coordenadas para o centro do canvas
                const x = centerX + point.x * 10;
                const y = centerY - point.y * 10;  // Subtraímos de 'centerY' para que as coordenadas Y aumentem para cima
                ctx.fillRect(x, y, 10, 10);  // Desenha o ponto como um quadrado de 5x5 pixels
            });
        }

        // Função para capturar os valores e desenhar a linha
        function desenharBresenham() {
            // Captura os valores inseridos pelo usuário
            let x0 = parseInt(document.getElementById('x0').value);
            let y0 = parseInt(document.getElementById('y0').value);
            let x1 = parseInt(document.getElementById('x1').value);
            let y1 = parseInt(document.getElementById('y1').value);

            // Pega os pontos da linha de Bresenham
            let points = bresenhamLine(x0 , y0+1, x1, y1+1);  // Sim isso é uma pequena gambiarra

            // Desenha a linha no canvas
            drawLine(points);
        }

        // criar circulo e elipse

        // Algoritmo de Bresenham para desenhar um círculo
        function bresenhamCircle(xc, yc, radius) {
            let points = [];
            let x = 0;
            let y = radius;
            let d = 3 - 2 * radius;

            while (y >= x) {
                points.push(...drawCirclePoints(xc, yc, x, y));
                x++;
                if (d > 0) {
                    y--;
                    d = d + 4 * (x - y) + 10;
                } else {
                    d = d + 4 * x + 6;
                }
            }
            return points;
        }

        function drawCirclePoints(xc, yc, x, y) {
            return [
                {x: xc + x, y: yc + y}, {x: xc - x, y: yc + y},
                {x: xc + x, y: yc - y}, {x: xc - x, y: yc - y},
                {x: xc + y, y: yc + x}, {x: xc - y, y: yc + x},
                {x: xc + y, y: yc - x}, {x: xc - y, y: yc - x}
            ];
        }

        // Algoritmo de Bresenham para desenhar uma elipse
        function bresenhamEllipse(xc, yc, rx, ry) {
            let points = [];
            let x = 0;
            let y = ry;
            let d1 = ry * ry - rx * rx * ry + 0.25 * rx * rx;
            let dx = 2 * ry * ry * x;
            let dy = 2 * rx * rx * y;

            while (dx < dy) {
                points.push(...drawEllipsePoints(xc, yc, x, y));
                if (d1 < 0) {
                    x++;
                    dx = dx + 2 * ry * ry;
                    d1 = d1 + dx + ry * ry;
                } else {
                    x++;
                    y--;
                    dx = dx + 2 * ry * ry;
                    dy = dy - 2 * rx * rx;
                    d1 = d1 + dx - dy + ry * ry;
                }
            }

            let d2 = ry * ry * (x + 0.5) * (x + 0.5) + rx * rx * (y - 1) * (y - 1) - rx * rx * ry * ry;
            while (y >= 0) {
                points.push(...drawEllipsePoints(xc, yc, x, y));
                if (d2 > 0) {
                    y--;
                    dy = dy - 2 * rx * rx;
                    d2 = d2 + rx * rx - dy;
                } else {
                    y--;
                    x++;
                    dx = dx + 2 * ry * ry;
                    dy = dy - 2 * rx * rx;
                    d2 = d2 + dx - dy + rx * rx;
                }
            }
            return points;
        }

        function drawEllipsePoints(xc, yc, x, y) {
            return [
                {x: xc + x, y: yc + y}, {x: xc - x, y: yc + y},
                {x: xc + x, y: yc - y}, {x: xc - x, y: yc - y}
            ];
        }

        function desenharCirculo() {
            // Captura os valores inseridos pelo usuário
            let x0 = parseInt(document.getElementById('x0').value);
            let y0 = parseInt(document.getElementById('y0').value);
            let X1 = parseInt(document.getElementById('x1').value);
            

            let points = bresenhamCircle(x0 , y0 +1, X1);  

            // Desenha a linha no canvas
            drawLine(points);
        }

        function desenharElipse() {
                // Captura os valores inseridos pelo usuário
                let x0 = parseInt(document.getElementById('x0').value);
                let y0 = parseInt(document.getElementById('y0').value);
                let x1 = parseInt(document.getElementById('x1').value);
                let y1 = parseInt(document.getElementById('y1').value);

                let points = bresenhamEllipse(x0, y0 + 1, x1, y1 );

                // Desenha a linha no canvas
                drawLine(points);
            }

    </script>
</body>
</html>
